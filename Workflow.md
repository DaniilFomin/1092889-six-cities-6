# Как работать над проектом

## Окружение

Для удобства работы над проектом используются инструменты из **Node.js** и **npm**. Все необходимые настройки произведены. Убедитесь, что на рабочем компьютере установлен актуальный LTS релиз Node.js**. Актуальная версия **Node.js** указана в файле `package.json` в поле `node`. Затем, в терминале, перейдите в директорию с проектом и _единожды_ запустите команду:

```bash
npm install
```

Команда запустит процесс установки зависимостей проекта из **npm**.

### Переменные окружения 

Приведены в файле .env.example или можно посмотреть здесь
```
PORT=4000 - Порт на котором работает приложение
HOST=localhost - Адрес приложения
SALT=someSecretRandomString - секретная строка для генерации пароля
JWT_SECRET=jwtSecret - секретная строка для генерации JWT токена
DB_ADDRESS=127.0.0.1 - адрес базы данных
DB_USER=user - Имя пользователя для базы данных
DB_PASSWORD=pass - Пароль для базы данных
DB_PORT=27017 - Порт базы данных
DB_NAME=six-cities - Имя базы данных
UPLOAD_DIRECTORY=assets - Папка для хранения загруженных файлов
STATIC_DIRECTORY=static - Папка для хранения статических файлов

DEFAULT_USER_PASSWORD=somePass - Стандартный пароль пользователя для генерации в консольном приложении 
```


### Сценарии

В `package.json` предопределено несколько сценариев.

#### Скомпилировать проект

```bash
npm run compile
```

Создаст директорию `dist` и скомпилирует проект.

#### Удалить скомпилированный проект

```bash
npm run clean
```

Удаляет директорию `dist`. Используется перед компиляцией.

#### Собрать проект

```bash
npm run build
```

Выполняет сборку проекта: удаляет ранее скомпилированный проект и компилирует заново.
Добавляет возможность исполнения для cli application

#### Проверить линтером

```bash
npm run lint
```

Запуск проверки проекта статическим анализатором кода **ESLint**.

Линтер проверяет файлы только внутри директории `src`.

**Обратите внимание**, при запуске данной команды, ошибки выводятся в терминал.

#### Запустить ts-модуль без компиляции

```bash
npm run ts -- <Путь к модулю с ts-кодом>
```

Пакет `tsx` позволяет выполнить TS-код в Node.js без предварительной компиляции. Используется только на этапе разработки.
## Запуск

#### Запустить REST версию проекта

```bash
npm start
```

В процессе запуска проекта будет выполнен процесс «Сборки проекта» и запуска REST версии проекта 

**Для корректной работы проекта требуется поднятая база данных, сделать это можно с помощью ```npm run start:db```**


#### Запустить CLI версию проекта

```bash
npm run cli
```
**!!Перед началом требутся собрать проект с помощью ```npm run build```**

**Для корректной работы проекта требуется поднять тестовый REST интерфейс и базу данных, сделать это можно с помощю команд: 
```npm run mock:server``` и ```npm run start:db``` соответственно**

Запускает консольную версию проекта с возможностью генерации и импорта в базу данных предложений об аренде.
Также возможно запустить с помощь исполняемого файла **main.cli.js** в директории **dist** 

Варианты использования консольного приложения можно увидеть через комманду ```--help``` или посмотреть здесь
```
Программа для подготовки данных для REST API сервера.
        Пример:
            ./main.cli.js --<command> [--arguments]
            или
            npm run cli --<command> [--arguments]
        Команды:
            --version:                          # выводит информации о версии приложения.
            --help:                             # выводит информацию о списке поддерживаемых команд.
            --import <path>                     # импортирует данные из TSV-файла в базу данных.
                                                - <path> - путь и название файла Tsv
            --generate <n> <filepath> <url>     # генерирует произвольное количество тестовых наборов
                                                - <n> - количество тестовых наборов
                                                - <filepath> - путь и название файла Tsv
                                                - <url> адрес сервера с данными для генерации




```

### Запустить проект в dev режиме

```
npm run start:dev
```
Проект будет запущен с удобочитаемым выводом логов в консоль c помощь nodemon

**Для корректной работы проекта требуется поднятая база данных, сделать это можно с помощью ```npm run start:db```**


### Запустить базу данных в Docker compose 

```
npm run start:db
```
Запускает docker-compose с настройками под проект


### Запустить тестовый REST API интерфейс

```
npm run mock:server
```
json-server powered REST API интерфейс с моковыми данными


## Структура проекта

### Директория `src`

Исходный код проекта: компоненты, модули и так далее. Структура директории `src` может быть произвольной.

### Файл `Readme.md`

Инструкции по работе с учебным репозиторием.

### Файл `Contributing.md`

Советы и инструкции по внесению изменений в учебный репозиторий.

### Остальное

Все остальные файлы в проекте являются служебными. Пожалуйста, не удаляйте и не изменяйте их самовольно. Только если того требует задание или наставник.
